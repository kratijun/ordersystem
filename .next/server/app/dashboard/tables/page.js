(()=>{var e={};e.id=16,e.ids=[16],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},7310:e=>{"use strict";e.exports=require("url")},1126:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>h,pages:()=>o,routeModule:()=>m,tree:()=>d});var r=a(7096),t=a(6132),l=a(7284),n=a.n(l),i=a(2564),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);a.d(s,c);let d=["",{children:["dashboard",{children:["tables",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,3121)),"C:\\Users\\olive\\Desktop\\ordersystem\\app\\dashboard\\tables\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,5581)),"C:\\Users\\olive\\Desktop\\ordersystem\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,9943)),"C:\\Users\\olive\\Desktop\\ordersystem\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Users\\olive\\Desktop\\ordersystem\\app\\dashboard\\tables\\page.tsx"],h="/dashboard/tables/page",x={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/dashboard/tables/page",pathname:"/dashboard/tables",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5388:(e,s,a)=>{Promise.resolve().then(a.bind(a,2387))},2387:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>TablesPage});var r=a(784),t=a(9885),l=a(4800),n=a(9576),i=a(599),c=a(5555),d=a(1890),o=a(3770),h=a(2451),x=a(2385),m=a(6206),u=a(517),g=a(1057),v=a(9551),j=a(6303),b=a(3680),p=a(4571),f=a(5441),N=a(1672),y=a(2032);function TablesPage(){let{user:e}=(0,l.useAuth)(),[s,a]=(0,t.useState)([]),[w,C]=(0,t.useState)(!0),[T,E]=(0,t.useState)(!1),[S,D]=(0,t.useState)(null),[_,R]=(0,t.useState)(null),[P,z]=(0,t.useState)({number:""}),[k,Z]=(0,t.useState)({name:"",phone:"",date:"",time:"",guests:2}),[F,G]=(0,t.useState)({reason:""});(0,t.useEffect)(()=>{fetchTables()},[]);let fetchTables=async()=>{try{let e=await n.ss.getAll();e.success&&a(e.data)}catch(e){console.error("Fehler beim Laden der Tische:",e)}finally{C(!1)}},handleAddTable=async()=>{if(P.number)try{let e=await n.ss.create({number:parseInt(P.number)});e.success&&(z({number:""}),E(!1),fetchTables())}catch(e){console.error("Fehler beim Hinzuf\xfcgen des Tisches:",e)}},handleUpdateTableStatus=async(e,s,a={})=>{try{let r=await n.ss.update(e,{status:s,...a});r.success&&(fetchTables(),D(null),R(null),Z({name:"",phone:"",date:"",time:"",guests:2}),G({reason:""}))}catch(e){console.error("Fehler beim Aktualisieren des Tischstatus:",e)}},handleReservation=async e=>{if(!k.name||!k.date||!k.time){alert("Bitte f\xfcllen Sie alle Pflichtfelder aus.");return}await handleUpdateTableStatus(e,"RESERVED",{reservationName:k.name,reservationPhone:k.phone,reservationDate:k.date,reservationTime:k.time,reservationGuests:k.guests})},handleCloseTable=async e=>{if(!F.reason){alert("Bitte geben Sie einen Grund f\xfcr die Schlie\xdfung an.");return}await handleUpdateTableStatus(e,"CLOSED",{closedReason:F.reason,reservationName:null,reservationPhone:null,reservationDate:null,reservationTime:null,reservationGuests:null})},handleDeleteTable=async e=>{if(confirm("Sind Sie sicher, dass Sie diesen Tisch l\xf6schen m\xf6chten?"))try{let s=await n.ss.delete(e);s.success&&fetchTables()}catch(e){console.error("Fehler beim L\xf6schen des Tisches:",e)}},getStatusBadge=e=>{switch(e){case"FREE":return r.jsx(d.C,{variant:"secondary",className:"bg-green-100 text-green-800",children:"Frei"});case"OCCUPIED":return r.jsx(d.C,{variant:"secondary",className:"bg-red-100 text-red-800",children:"Belegt"});case"RESERVED":return r.jsx(d.C,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Reserviert"});case"CLOSED":return r.jsx(d.C,{variant:"secondary",className:"bg-gray-100 text-gray-800",children:"Geschlossen"});default:return r.jsx(d.C,{variant:"secondary",children:e})}},getStatusColor=e=>{switch(e){case"FREE":return"bg-green-50 border-green-200 hover:bg-green-100";case"OCCUPIED":return"bg-red-50 border-red-200 hover:bg-red-100";case"RESERVED":return"bg-yellow-50 border-yellow-200 hover:bg-yellow-100";case"CLOSED":return"bg-gray-50 border-gray-200 hover:bg-gray-100";default:return"bg-gray-50 border-gray-200"}},formatDateTime=(e,s)=>{if(!e||!s)return"";let a=new Date(`${e}T${s}`);return a.toLocaleString("de-DE",{weekday:"short",day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})};return w?r.jsx("div",{className:"flex justify-center items-center h-64",children:"Laden..."}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tischverwaltung"}),r.jsx("p",{className:"text-gray-600 mt-2",children:"Verwalten Sie die Tische, Reservierungen und deren Status in Ihrem Restaurant."})]}),e?.role==="ADMIN"&&(0,r.jsxs)(c.z,{onClick:()=>E(!0),children:[r.jsx(x.Z,{className:"mr-2 h-4 w-4"}),"Tisch hinzuf\xfcgen"]})]}),T&&(0,r.jsxs)(i.Zb,{children:[r.jsx(i.Ol,{children:r.jsx(i.ll,{children:"Neuen Tisch hinzuf\xfcgen"})}),r.jsx(i.aY,{children:(0,r.jsxs)("div",{className:"flex items-end space-x-4",children:[(0,r.jsxs)("div",{children:[r.jsx(h._,{htmlFor:"tableNumber",children:"Tischnummer"}),r.jsx(o.I,{id:"tableNumber",type:"number",value:P.number,onChange:e=>z({number:e.target.value}),placeholder:"z.B. 1"})]}),r.jsx(c.z,{onClick:handleAddTable,children:"Hinzuf\xfcgen"}),r.jsx(c.z,{variant:"outline",onClick:()=>E(!1),children:"Abbrechen"})]})})]}),S&&(0,r.jsxs)(i.Zb,{children:[r.jsx(i.Ol,{children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)(i.ll,{children:["Tisch ",s.find(e=>e.id===S)?.number," reservieren"]}),r.jsx(c.z,{variant:"ghost",size:"sm",onClick:()=>D(null),children:r.jsx(m.Z,{className:"h-4 w-4"})})]})}),(0,r.jsxs)(i.aY,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx(h._,{htmlFor:"reservationName",children:"Name *"}),r.jsx(o.I,{id:"reservationName",value:k.name,onChange:e=>Z({...k,name:e.target.value}),placeholder:"Name des Gastes"})]}),(0,r.jsxs)("div",{children:[r.jsx(h._,{htmlFor:"reservationPhone",children:"Telefonnummer"}),r.jsx(o.I,{id:"reservationPhone",value:k.phone,onChange:e=>Z({...k,phone:e.target.value}),placeholder:"Optional"})]}),(0,r.jsxs)("div",{children:[r.jsx(h._,{htmlFor:"reservationDate",children:"Datum *"}),r.jsx(o.I,{id:"reservationDate",type:"date",value:k.date,onChange:e=>Z({...k,date:e.target.value})})]}),(0,r.jsxs)("div",{children:[r.jsx(h._,{htmlFor:"reservationTime",children:"Uhrzeit *"}),r.jsx(o.I,{id:"reservationTime",type:"time",value:k.time,onChange:e=>Z({...k,time:e.target.value})})]}),(0,r.jsxs)("div",{children:[r.jsx(h._,{htmlFor:"reservationGuests",children:"Anzahl G\xe4ste"}),r.jsx(o.I,{id:"reservationGuests",type:"number",min:"1",max:"20",value:k.guests,onChange:e=>Z({...k,guests:parseInt(e.target.value)||2})})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2 mt-4",children:[(0,r.jsxs)(c.z,{onClick:()=>handleReservation(S),children:[r.jsx(u.Z,{className:"mr-2 h-4 w-4"}),"Reservierung best\xe4tigen"]}),r.jsx(c.z,{variant:"outline",onClick:()=>D(null),children:"Abbrechen"})]})]})]}),_&&(0,r.jsxs)(i.Zb,{children:[r.jsx(i.Ol,{children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)(i.ll,{children:["Tisch ",s.find(e=>e.id===_)?.number," schlie\xdfen"]}),r.jsx(c.z,{variant:"ghost",size:"sm",onClick:()=>R(null),children:r.jsx(m.Z,{className:"h-4 w-4"})})]})}),(0,r.jsxs)(i.aY,{children:[(0,r.jsxs)("div",{children:[r.jsx(h._,{htmlFor:"closeReason",children:"Grund f\xfcr Schlie\xdfung *"}),r.jsx(o.I,{id:"closeReason",value:F.reason,onChange:e=>G({reason:e.target.value}),placeholder:"z.B. Reparatur, Reinigung, defekter Stuhl..."})]}),(0,r.jsxs)("div",{className:"flex space-x-2 mt-4",children:[(0,r.jsxs)(c.z,{onClick:()=>handleCloseTable(_),variant:"destructive",children:[r.jsx(g.Z,{className:"mr-2 h-4 w-4"}),"Tisch schlie\xdfen"]}),r.jsx(c.z,{variant:"outline",onClick:()=>R(null),children:"Abbrechen"})]})]})]}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:s.map(s=>r.jsx(i.Zb,{className:`transition-all duration-200 ${getStatusColor(s.status)} border-2`,children:(0,r.jsxs)(i.aY,{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx(v.Z,{className:"h-5 w-5"}),(0,r.jsxs)("span",{className:"font-bold text-lg",children:["Tisch ",s.number]})]}),e?.role==="ADMIN"&&r.jsx(c.z,{variant:"ghost",size:"sm",onClick:()=>handleDeleteTable(s.id),className:"text-red-500 hover:text-red-700 h-6 w-6 p-0",children:r.jsx(j.Z,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[getStatusBadge(s.status),"RESERVED"===s.status&&s.reservationName&&(0,r.jsxs)("div",{className:"bg-yellow-50 p-2 rounded-md border border-yellow-200",children:[(0,r.jsxs)("div",{className:"flex items-center text-sm text-yellow-800 mb-1",children:[r.jsx(b.Z,{className:"h-3 w-3 mr-1"}),r.jsx("span",{className:"font-medium",children:s.reservationName})]}),s.reservationPhone&&(0,r.jsxs)("div",{className:"flex items-center text-xs text-yellow-700 mb-1",children:[r.jsx(p.Z,{className:"h-3 w-3 mr-1"}),s.reservationPhone]}),s.reservationDate&&s.reservationTime&&(0,r.jsxs)("div",{className:"flex items-center text-xs text-yellow-700 mb-1",children:[r.jsx(f.Z,{className:"h-3 w-3 mr-1"}),formatDateTime(s.reservationDate,s.reservationTime)]}),s.reservationGuests&&(0,r.jsxs)("div",{className:"flex items-center text-xs text-yellow-700",children:[r.jsx(N.Z,{className:"h-3 w-3 mr-1"}),s.reservationGuests," G\xe4ste"]})]}),"CLOSED"===s.status&&s.closedReason&&r.jsx("div",{className:"bg-gray-50 p-2 rounded-md border border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-700",children:[r.jsx(g.Z,{className:"h-3 w-3 mr-1"}),r.jsx("span",{className:"text-xs",children:s.closedReason})]})}),s._count&&s._count.orders>0&&(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[r.jsx(N.Z,{className:"h-4 w-4 mr-1"}),s._count.orders," Bestellung(en)"]})]}),(0,r.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:["FREE"!==s.status&&(0,r.jsxs)(c.z,{size:"sm",variant:"outline",onClick:()=>handleUpdateTableStatus(s.id,"FREE",{reservationName:null,reservationPhone:null,reservationDate:null,reservationTime:null,reservationGuests:null,closedReason:null}),className:"text-xs h-7 px-2 bg-green-50 hover:bg-green-100 border-green-200",children:[r.jsx(y.Z,{className:"h-3 w-3 mr-1"}),"Frei"]}),"OCCUPIED"!==s.status&&"CLOSED"!==s.status&&(0,r.jsxs)(c.z,{size:"sm",variant:"outline",onClick:()=>handleUpdateTableStatus(s.id,"OCCUPIED"),className:"text-xs h-7 px-2 bg-red-50 hover:bg-red-100 border-red-200",children:[r.jsx(N.Z,{className:"h-3 w-3 mr-1"}),"Belegt"]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:["RESERVED"!==s.status&&"CLOSED"!==s.status&&(0,r.jsxs)(c.z,{size:"sm",variant:"outline",onClick:()=>D(s.id),className:"text-xs h-7 px-2 bg-yellow-50 hover:bg-yellow-100 border-yellow-200",children:[r.jsx(u.Z,{className:"h-3 w-3 mr-1"}),"Reservieren"]}),"CLOSED"!==s.status&&e?.role==="ADMIN"&&(0,r.jsxs)(c.z,{size:"sm",variant:"outline",onClick:()=>R(s.id),className:"text-xs h-7 px-2 bg-gray-50 hover:bg-gray-100 border-gray-200",children:[r.jsx(g.Z,{className:"h-3 w-3 mr-1"}),"Schlie\xdfen"]})]})]})]})},s.id))}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(i.Zb,{children:r.jsx(i.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["Freie Tische: ",s.filter(e=>"FREE"===e.status).length]})]})})}),r.jsx(i.Zb,{children:r.jsx(i.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["Belegte Tische: ",s.filter(e=>"OCCUPIED"===e.status).length]})]})})}),r.jsx(i.Zb,{children:r.jsx(i.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["Reservierte Tische: ",s.filter(e=>"RESERVED"===e.status).length]})]})})}),r.jsx(i.Zb,{children:r.jsx(i.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded-full"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["Geschlossene Tische: ",s.filter(e=>"CLOSED"===e.status).length]})]})})})]})]})}},3121:(e,s,a)=>{"use strict";a.r(s),a.d(s,{$$typeof:()=>n,__esModule:()=>l,default:()=>c});var r=a(5153);let t=(0,r.createProxy)(String.raw`C:\Users\olive\Desktop\ordersystem\app\dashboard\tables\page.tsx`),{__esModule:l,$$typeof:n}=t,i=t.default,c=i}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),a=s.X(0,[204,80,61,524,812,82,828,844,41,890,928],()=>__webpack_exec__(1126));module.exports=a})();